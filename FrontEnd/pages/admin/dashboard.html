<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Admin • Dashboard</title>
  <link rel="stylesheet" href="../../assets/css/style.css">
  <link rel="stylesheet" href="../../assets/css/admin.css">
  <script src="../../assets/js/config.js"></script>
  <script src="../../assets/js/api.js"></script>
  <script src="../../assets/js/util.js"></script>
  <script src="../../assets/js/admin-dashboard.js" defer></script>

  <style>
  /* ===== Sidebar UTH-like ===== */
  .uth-bar{width:280px;background:#fff;border-right:1px solid #e5e7eb;
    position:fixed;left:0;top:60px;bottom:0;z-index:20}
  .with-sidebar{margin-left:280px}
  .uth-head{display:flex;align-items:center;gap:10px;padding:10px 12px}
  .uth-close{width:32px;height:32px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;cursor:pointer}
  .uth-close:hover{background:#f3f4f6}
  .uth-nav{height:calc(100% - 52px);overflow:auto;padding:8px 6px 16px}
  .uth-root{display:block;margin:6px 8px 10px;padding:10px 12px;border-radius:10px;
    text-decoration:none;color:#0f172a;border:1px solid #e5e7eb;background:#fff}
  .uth-active{background:#0ea5e9;color:#fff;border-color:#0ea5e9}

  .uth-group{margin:8px 6px;border:1px solid #e5e7eb;border-radius:12px;background:#fff}
  .uth-group>summary{list-style:none;padding:10px 12px;border-radius:12px;cursor:pointer;
    display:flex;align-items:center;gap:8px;font-weight:600}
  .uth-group>summary::-webkit-details-marker{display:none}
  .uth-group>summary:hover{background:#f8fafc}
  .chev{transition:transform .15s ease}
  .uth-group[open] .chev{transform:rotate(90deg)}

  .uth-list{list-style:none;margin:0;padding:6px 0 10px}
  .uth-list li{position:relative}
  .uth-list a{display:flex;align-items:center;gap:8px;padding:8px 12px 8px 36px;
    margin:2px 6px;border-radius:10px;color:#0f172a;text-decoration:none}
  .uth-list a:hover{background:#f3f4f6}
  .uth-list li::before{content:"";position:absolute;left:16px;top:50%;
    width:12px;height:12px;border-radius:50%;transform:translateY(-50%);
    border:2px solid #9ca3af;background:#fff}
  .uth-list li.is-done::before{background:#10b981;border-color:#10b981}

  @media (max-width: 1024px){
    .with-sidebar{margin-left:0}
    .uth-bar{top:56px;transform:translateX(-100%);transition:transform .2s ease}
    .uth-bar.open{transform:translateX(0)}
  }
  </style>
</head>
<body>
<header class="site-header">
  <div class="hdr-wrap">
    <div class="brand">
      <a href="../../index.html" class="brand-link">TourBooking</a>
      <span class="brand-dot">•</span><span class="brand-sub">Admin</span>
    </div>
    <nav class="hdr-nav">
      <a href="../../index.html">Home</a>
      <a href="../tours.html">Tours</a>
      <a href="../my-bookings.html" class="nav-my" style="display:none">My bookings</a>
      <a href="./dashboard.html" class="nav-admin" style="display:none">Admin</a>
      <a href="../login.html" class="nav-login">Login</a>
      <a href="#" onclick="logout()" class="nav-logout" style="display:none">Logout</a>
    </nav>
  </div>
</header>

<!-- Sidebar -->
<aside id="sidebar" class="sb uth-bar">
  <div class="uth-head">
    <button class="uth-close" id="uthClose" aria-label="Toggle">✕</button>
    <strong>Admin</strong>
  </div>

  <nav class="uth-nav">
    <a class="uth-root" href="./dashboard.html">🏠 Dashboard</a>

    <details class="uth-group" open>
      <summary><span class="chev">▸</span> Quản trị nội dung</summary>
      <ul class="uth-list">
        <li class="is-done"><a href="./categories.html">📁 Categories</a></li>
        <li><a href="./tours.html">🧭 Tours</a></li>
        <li><a href="./photos.html">🖼️ Photos</a></li>
      </ul>
    </details>

    <details class="uth-group">
      <summary><span class="chev">▸</span> Bán hàng</summary>
      <ul class="uth-list">
        <li><a href="./discounts.html">🏷️ Discounts</a></li>
        <li><a href="./bookings.html">🧾 Bookings</a></li>
      </ul>
    </details>

    <details class="uth-group">
      <summary><span class="chev">▸</span> Người dùng</summary>
      <ul class="uth-list">
        <li><a href="./users.html">👤 Users & Roles</a></li>
      </ul>
    </details>
  </nav>
</aside>

<main class="container admin-container with-sidebar">
  <section class="dash-top">
    <div>
      <h1 class="dash-title">Bảng điều khiển</h1>
    </div>
    <div class="user-chip">
      <div class="u-dot"></div>
      <div>
        <div class="u-role" id="roleName">admin</div>
        <div class="u-email" id="userEmail"></div>
      </div>
      <button class="btn light small" onclick="location.href='../login.html'">Switch user</button>
    </div>
  </section>

  <section class="stats-grid">
    <div class="stat-card gradient-1"><div class="stat-label">Tổng Tours</div><div class="stat-value" id="statTours">—</div><div class="stat-foot" id="statToursHint">đang tải…</div></div>
    <div class="stat-card gradient-2"><div class="stat-label">Bookings (Tổng)</div><div class="stat-value" id="statBookings">—</div><div class="stat-foot" id="statBookingsHint">đang tải…</div></div>
    <div class="stat-card gradient-3"><div class="stat-label">Pending</div><div class="stat-value" id="statPending">—</div><div class="stat-foot" id="statPendingHint">đang tải…</div></div>
    <div class="stat-card gradient-4"><div class="stat-label">Doanh thu 30 ngày</div><div class="stat-value" id="statRevenue">—</div><div class="stat-foot">đã xác nhận (Confirmed)</div></div>
    <div class="stat-card gradient-5"><div class="stat-label">Khách hàng</div><div class="stat-value" id="statUsers">—</div><div class="stat-foot" id="statUsersHint">đang tải…</div></div>
    <div class="stat-card gradient-6"><div class="stat-label">Categories</div><div class="stat-value" id="statCats">—</div><div class="stat-foot" id="statCatsHint">đang tải…</div></div>
  </section>

  <section class="panel">
    <div class="panel-head"><h2 class="panel-title">Bookings gần đây</h2><a class="btn small" href="./bookings.html">Xem tất cả</a></div>
    <table class="table compact">
      <thead><tr><th>ID</th><th>User</th><th>Tour</th><th>People</th><th>Status</th><th>Total</th><th>Created</th></tr></thead>
      <tbody id="recentBookings"><tr><td colspan="7" class="muted">Đang tải…</td></tr></tbody>
    </table>
  </section>

  <section class="panel">
    <div class="panel-head"><h2 class="panel-title">Tours mới</h2><a class="btn small" href="./tours.html">Quản lý</a></div>
    <div class="cards-compact" id="recentTours"><div class="muted">Đang tải…</div></div>
  </section>
</main>

<footer class="site-footer">© TourBooking • Admin</footer>
<script src="../../assets/js/admin-shell.js" defer></script>

<script>
/* Toggle & active item */
(function(){
  const sb = document.getElementById('sidebar');
  const btn = document.getElementById('uthClose');
  const KEY='uth_sb_open';
  function setOpen(v){ sb.classList.toggle('open',v); localStorage.setItem(KEY,v?'1':'0'); }
  const initOpen = localStorage.getItem(KEY)==='1';
  if(initOpen) sb.classList.add('open');
  if(btn) btn.addEventListener('click',()=> setOpen(!sb.classList.contains('open')));
  // highlight active
  const here = location.pathname.split('/').pop();
  document.querySelectorAll('.uth-list a,.uth-root').forEach(a=>{
    const href = a.getAttribute('href')||'';
    if(href && here && href.endsWith(here)) a.classList.add('uth-active');
  });
})();
</script>

</body>
</html>
